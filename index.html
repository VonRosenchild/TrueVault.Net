<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>TrueVault.Net by hsrob</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>TrueVault.Net</h1>
        <p>.NET wrapper for the TrueVault API</p>

        <p class="view"><a href="https://github.com/hsrob/TrueVault.Net">View the Project on GitHub <small>hsrob/TrueVault.Net</small></a></p>


        <ul>
          <li><a href="https://github.com/hsrob/TrueVault.Net/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/hsrob/TrueVault.Net/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/hsrob/TrueVault.Net">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="truevaultnet" class="anchor" href="#truevaultnet"><span class="octicon octicon-link"></span></a>TrueVault.Net</h1>

<p>.NET wrapper for the TrueVault API</p>

<h3>
<a name="what-is-truevault-and-what-is-this-library" class="anchor" href="#what-is-truevault-and-what-is-this-library"><span class="octicon octicon-link"></span></a>What is TrueVault, and what is this library?</h3>

<p>TrueVault is a Secure API to store health data. See their website at <a href="https://www.truevault.com">https://www.truevault.com</a> for more information.</p>

<p>This library is a simple, strongly-typed .NET wrapper around TrueVault's RESTful API.</p>

<h3>
<a name="features-white_check_mark-completed-and-heavy_minus_sign-planned" class="anchor" href="#features-white_check_mark-completed-and-heavy_minus_sign-planned"><span class="octicon octicon-link"></span></a>Features (<img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2705.png" height="20" width="20" align="absmiddle"> Completed and <img class="emoji" title=":heavy_minus_sign:" alt=":heavy_minus_sign:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2796.png" height="20" width="20" align="absmiddle"> Planned)</h3>

<ul>
<li>
<img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2705.png" height="20" width="20" align="absmiddle"> JSON Document Store API</li>
<li>
<img class="emoji" title=":heavy_minus_sign:" alt=":heavy_minus_sign:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2796.png" height="20" width="20" align="absmiddle"> BLOB Store API</li>
<li>
<img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2705.png" height="20" width="20" align="absmiddle"> Search Schema management API (Get/Create/Update/Delete Schemas)

<ul>
<li>
<img class="emoji" title=":heavy_minus_sign:" alt=":heavy_minus_sign:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2796.png" height="20" width="20" align="absmiddle"> Search API</li>
</ul>
</li>
</ul><h3>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Install via NuGet <code>Install-Package TrueVault.Net</code> or clone the repository, make sure NuGet packages are restored, and compile.</p>

<h3>
<a name="external-dependencies" class="anchor" href="#external-dependencies"><span class="octicon octicon-link"></span></a>External Dependencies</h3>

<blockquote>
<ul>
<li>ServiceStack.Text 3.9.71</li>
<li>AutoMapper 3.2.1</li>
</ul>
</blockquote>

<h4>
<a name="test-project-only" class="anchor" href="#test-project-only"><span class="octicon octicon-link"></span></a>Test Project Only</h4>

<blockquote>
<ul>
<li>NBuilder 3.0.1.1</li>
<li>NUnit 2.6.3</li>
</ul>
</blockquote>

<h2>
<a name="release-notes" class="anchor" href="#release-notes"><span class="octicon octicon-link"></span></a>Release Notes</h2>

<h3>
<a name="version-103" class="anchor" href="#version-103"><span class="octicon octicon-link"></span></a>Version 1.0.3</h3>

<ul>
<li>Implement the new Get Document List API method, which returns a paginated list of all documents in a vault</li>
</ul><h3>
<a name="version-102" class="anchor" href="#version-102"><span class="octicon octicon-link"></span></a>Version 1.0.2</h3>

<ul>
<li>Implement Search Schema management API</li>
</ul><h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<h2>
<a name="instantiation" class="anchor" href="#instantiation"><span class="octicon octicon-link"></span></a>Instantiation</h2>

<p>Create a new instance of the TrueVault client, passing in your TrueVault API key, and you're ready to go!</p>

<div class="highlight highlight-csharp"><pre><span class="kt">var</span> <span class="n">trueVaultClient</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TrueVaultClient</span><span class="p">(</span><span class="s">"{TrueVault API Key}"</span><span class="p">);</span>
</pre></div>

<h2>
<a name="json-document-store-api" class="anchor" href="#json-document-store-api"><span class="octicon octicon-link"></span></a>JSON Document Store API</h2>

<h3>
<a name="creating-a--document" class="anchor" href="#creating-a--document"><span class="octicon octicon-link"></span></a>Creating a  Document</h3>

<p>This library automatically handles Base64 conversion and serialization. You only need to pass an instance of Type <code>T</code> to save it to TrueVault. <code>T</code> can be any class with a parameterless constructor.</p>

<p>A document can be created with or without the optional <code>schemaId</code> parameter via the appropriate overloaded <code>CreateDocument&lt;T&gt;</code> method.</p>

<h3>
<a name="getting-documents" class="anchor" href="#getting-documents"><span class="octicon octicon-link"></span></a>Getting Document(s)</h3>

<h4>
<a name="individual-document-by-id" class="anchor" href="#individual-document-by-id"><span class="octicon octicon-link"></span></a>Individual Document by ID</h4>

<p><code>GetDocument&lt;T&gt;</code> is used to retrieve a single document from TrueVault, and will directly return an instance of Type <code>T</code>. Base64 conversion and deserialization is handled for you.</p>

<h4>
<a name="multiple-specific-documents-by-id" class="anchor" href="#multiple-specific-documents-by-id"><span class="octicon octicon-link"></span></a>Multiple Specific Documents by ID</h4>

<p><code>MultiGetDocuments&lt;T&gt;</code> retrieves a <code>MultiDocumentResponse</code>, which contains a list of <code>DocumentResponse</code> in its <code>Documents</code> property. You can use the <code>DeserializeDocuments&lt;T&gt;</code> method to extract and return the wrapped document instances as Type <code>T</code>.</p>

<p>Each <code>DocumentResponse</code> exposes a <code>DeserializeDocument&lt;T&gt;</code> method, which extracts and returns the individual document as Type <code>T</code>. <code>DocumentResponse</code> contains the TrueVault document ID in its <code>Id</code> property, as well as the raw serialized Base64 encoded JSON string in its <code>Document</code> property.</p>

<h4>
<a name="paginated-list-of-all-documents" class="anchor" href="#paginated-list-of-all-documents"><span class="octicon octicon-link"></span></a>Paginated List of All Documents</h4>

<p><code>GetDocumentList</code> retrieves a <code>DocumentGetListResponse</code>, which contains a <code>Data</code> property, which in turn contains info about the request, and <code>List&lt;DocumentGetListItem&gt;</code> in its <code>Items</code> property. You can use the <code>DeserializeDocuments&lt;T&gt;</code> method to extract and return the wrapped document instances as Type <code>T</code>.</p>

<p>Each <code>DocumentGetListItem</code> exposes a <code>DeserializeDocument&lt;T&gt;</code> method, which extracts and returns the individual document as Type <code>T</code>. <code>DocumentGetListItem</code> contains the TrueVault document ID in its <code>Id</code> property, the TrueVault Schema ID the document was indexed under (if any) in its <code>SchemaId</code> property, the TrueVault Vault ID in its <code>VaultId</code> property, and the raw serialized Base64 encoded JSON string in its <code>Document</code> property.</p>

<h2>
<a name="schema-api" class="anchor" href="#schema-api"><span class="octicon octicon-link"></span></a>Schema API</h2>

<h3>
<a name="creating-a-schema" class="anchor" href="#creating-a-schema"><span class="octicon octicon-link"></span></a>Creating a Schema</h3>

<p>Create a new instance of <code>Schema</code> or <code>Schema&lt;T&gt;</code>.</p>

<p>You can pass new instances of <code>SchemaField</code> via the <code>Schema</code>/<code>Schema&lt;T&gt;</code> constructor, or simply add them to the <code>Fields</code> List after construction. Check the Intellisense notes for further details about the various properties.</p>

<p><code>Schema&lt;T&gt;</code> is derived from <code>Schema</code>, but it isn't necessary to use this generic version. It simply adds a convenience method, <code>RegisterNestedField&lt;TNested&gt;</code>, which accepts <code>fieldExpression</code>, which is a <code>MemberExpression</code> pointing to a complex property on <code>T</code>, and <code>nestedFieldExpression</code>, which is a <code>MemberExpression</code> pointing to a primitive property on <code>TNested</code>. This method will also attempt to determine the TrueVault Schema compatible type of the property on <code>TNested</code>. See the Intellisense notes and Unit Tests for further details.</p>

<p>When your <code>Schema</code> is ready, call <code>TrueVaultClient.CreateSchema</code> to save it, which will return a <code>SchemaSaveSuccessResponse</code>, containing a <code>Schema</code> property that should be the same as the <code>Schema</code> you saved.</p>

<h3>
<a name="getting-schemas" class="anchor" href="#getting-schemas"><span class="octicon octicon-link"></span></a>Getting Schema(s)</h3>

<p>Call <code>TrueVaultClient.GetSchema</code> and <code>TrueVaultClient.GetSchemaList</code> to get one or all <code>Schema</code>s, respectively. The responses will contain a <code>Schema</code> or <code>IEnumerable&lt;Schema&gt;</code>, respectively.</p>

<h3>
<a name="exception-handling" class="anchor" href="#exception-handling"><span class="octicon octicon-link"></span></a>Exception Handling</h3>

<p>When the library catches a <code>WebException</code>, it will make an attempt to parse and unwrap the <code>error</code> object in an error response from TrueVault. It will throw a new <code>WebException</code> with the original exception in the <code>InnerException</code> property, and a message formatted as follows, where <code>response</code> is the error response body returned by TrueVault.</p>

<p><code>TrueVault Transaction ID {response.transaction_id} - {HTTP Status Code} Error (Type: {response.error.type}) [Code: {response.error.code}]: {response.error.message}</code></p>

<h2>
<a name="running-the-tests" class="anchor" href="#running-the-tests"><span class="octicon octicon-link"></span></a>Running the Tests</h2>

<p>Update App.config in the TrueVault.Net.Test project with the values you wish to use for testing. Please note that the tests use the TrueVault API, so you may incur a small amount of usage by running them. Per the license, you agree that I cannot be held responsible for any usage charges, fees, overages, etc. you may incur by running the tests.</p>

<h1>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h1>

<p>Pull requests are welcome. If you're planning on adding a major feature, please contact me first to make sure it fits with the direction of the library, and that I'm not already working on it!</p>

<h1>
<a name="legal" class="anchor" href="#legal"><span class="octicon octicon-link"></span></a>Legal</h1>

<p>This library is made available under The MIT License. By using this library, you agree to the terms of that license.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/hsrob">hsrob</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-35498989-4");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>